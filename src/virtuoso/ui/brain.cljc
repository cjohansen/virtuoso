(ns virtuoso.ui.brain
  (:require [clojure.string :as str]))

(def themes
  {:default {:text ["oklch(var(--bc))"]
             #_#_:gradient ["oklch(var(--su)"
                        "oklch(var(--su)"
                        "oklch(var(--er))"]
             :gradient ["oklch(var(--p)"
                        "oklch(var(--p)"
                        "oklch(var(--a))"]}})

(defn brain [& [{:keys [theme id] :as opt}]]
  (let [theme (or theme (:default themes))
        text (cycle (:text theme))
        id (or id (-> (str/join "" (:gradient theme))
                      (str/replace #"[^a-zA-Z0-9]" "")))
        gradient-id (str "gradient-" id)
        include-text? (get opt :text? true)]
    [:svg {:xmlns "http://www.w3.org/2000/svg"
           :view-box (if include-text?
                       "60 30 840 500"
                       "284 30 472 470")
           :class (:class opt)}
     [:g {}
      (when include-text?
        [:g {}
         [:path {:fill (nth text 0) :d "M181,415.9l-46,106h-22l-46-106h19.6l37.5,86.2l37.3-86.2H181z"}]
         [:path {:fill (nth text 1) :d "M195.7,521.9v-106h17.9v106H195.7z"}]
         [:path {:fill (nth text 2) :d "M322.4,521.9h-21.2l-20.1-31.3h-21.8v31.3h-5.4h-12.6v-106h46.5c5.3,0,10.3,1,14.9,2.9
                        c4.6,2,8.7,4.6,12.1,8c3.5,3.4,6.2,7.3,8.2,11.9c2,4.6,3,9.4,3,14.5c0,4-0.6,7.9-1.9,11.6c-1.3,3.7-3,7.1-5.2,10.1
                        c-2.2,3-4.9,5.7-8,8c-3.1,2.3-6.5,4.1-10.2,5.4L322.4,521.9z M287.8,472.7c2.8,0,5.5-0.5,7.9-1.5c2.4-1,4.6-2.4,6.4-4.2
                        c1.8-1.7,3.3-3.8,4.4-6.2c1.1-2.4,1.6-4.9,1.6-7.5c0-2.7-0.5-5.2-1.6-7.6c-1.1-2.3-2.6-4.4-4.4-6.1c-1.8-1.7-4-3.1-6.4-4.2
                        c-2.4-1-5.1-1.5-7.9-1.5h-28.5v38.8H287.8z"}]
         [:path {:fill (nth text 3) :d "M420.4,433.9h-34.1v88h-17.9v-88h-34.1v-17.9h86.1V433.9z"}]
         [:path {:fill (nth text 4) :d "M482.5,523.7c-6.4,0-12.5-1.2-18.1-3.6c-5.7-2.4-10.6-5.6-14.8-9.7c-4.2-4.1-7.6-8.9-10-14.4
                        c-2.4-5.5-3.7-11.4-3.7-17.6v-62.4h17.9v62.4c0,3.8,0.8,7.4,2.3,10.7c1.5,3.3,3.6,6.2,6.2,8.7c2.6,2.5,5.6,4.5,9.1,5.9
                        c3.5,1.4,7.2,2.1,11.1,2.1c3.9,0,7.6-0.7,11.1-2.1s6.5-3.4,9.1-5.9c2.6-2.5,4.7-5.4,6.2-8.7c1.5-3.3,2.3-6.9,2.3-10.7v-62.4h17.9
                        v62.4c0,6.2-1.2,12.1-3.7,17.6c-2.4,5.5-5.8,10.4-10,14.4c-4.2,4.1-9.2,7.3-14.8,9.7C494.9,522.5,488.9,523.7,482.5,523.7z"}]
         [:path {:fill (nth text 5) :d "M605.7,523.7c-7.7,0-15-1.4-21.8-4.3s-12.8-6.8-17.9-11.7c-5.1-4.9-9.1-10.8-12.1-17.4
                        c-2.9-6.7-4.4-13.8-4.4-21.3c0-7.5,1.5-14.6,4.4-21.3c2.9-6.7,7-12.5,12.1-17.4c5.1-4.9,11.1-8.9,17.9-11.7s14.1-4.3,21.8-4.3
                        c7.8,0,15.2,1.4,22,4.3c6.8,2.9,12.8,6.8,17.9,11.7c5.1,4.9,9.1,10.8,12.1,17.4c2.9,6.7,4.4,13.8,4.4,21.3
                        c0,7.5-1.5,14.6-4.4,21.3c-2.9,6.7-7,12.5-12.1,17.4c-5.1,4.9-11.1,8.9-17.9,11.7C620.9,522.3,613.6,523.7,605.7,523.7z
                         M605.7,432.1c-5.2,0-10.2,1-14.8,2.9c-4.7,1.9-8.7,4.5-12.2,7.9c-3.5,3.4-6.2,7.3-8.2,11.7c-2,4.5-3,9.2-3,14.3s1,9.9,3,14.3
                        c2,4.5,4.8,8.4,8.2,11.7c3.5,3.4,7.6,6,12.2,7.9c4.7,1.9,9.6,2.9,14.8,2.9c5.3,0,10.3-0.9,15-2.9c4.7-1.9,8.7-4.5,12.2-7.9
                        c3.5-3.4,6.2-7.3,8.2-11.7c2-4.5,3-9.2,3-14.3s-1-9.9-3-14.3c-2-4.5-4.8-8.4-8.2-11.7c-3.5-3.4-7.6-6-12.2-7.9
                        C616.1,433,611.1,432.1,605.7,432.1z"}]
         [:path {:fill (nth text 6) :d "M686.1,521.9V504h43.5c1.5,0,3.1-0.2,4.6-0.7c1.6-0.4,3-1.1,4.2-2c1.2-0.9,2.3-2.1,3-3.5
                        c0.8-1.4,1.1-3.1,1.1-5.1c0-1.7-0.4-3.3-1.2-4.6c-0.8-1.3-2.1-2.5-3.9-3.6c-1.8-1.1-4.2-2.1-7.1-3.2c-2.9-1-6.6-2.1-10.9-3.3
                        c-3.9-1.1-8-2.4-12.4-3.8c-4.3-1.5-8.3-3.4-12-5.8c-3.6-2.4-6.7-5.5-9-9.2c-2.4-3.7-3.6-8.4-3.6-14.1c0-4.1,0.8-8,2.4-11.6
                        c1.6-3.6,3.7-6.7,6.5-9.3c2.8-2.6,6-4.6,9.8-6.1c3.8-1.5,7.9-2.2,12.3-2.2H757v17.9h-43.5c-1.6,0-3.2,0.2-4.7,0.6
                        c-1.5,0.4-2.9,1.1-4.2,2s-2.3,2.1-3,3.5c-0.8,1.4-1.1,3.1-1.1,5.1c0,2,0.4,3.6,1.2,5c0.8,1.4,2.1,2.6,4,3.8
                        c1.8,1.2,4.3,2.3,7.3,3.3c3,1,6.8,2.2,11.2,3.5c3.8,1.1,7.9,2.3,12.1,3.8c4.3,1.4,8.2,3.3,11.8,5.6c3.6,2.3,6.5,5.3,8.9,9
                        c2.3,3.6,3.5,8.2,3.5,13.6c0,4.1-0.8,8-2.4,11.6c-1.6,3.6-3.8,6.7-6.5,9.3c-2.8,2.6-6.1,4.6-9.9,6.1c-3.8,1.5-7.9,2.2-12.2,2.2
                        H686.1z"}]
         [:path {:fill (nth text 7) :d "M837.2,523.7c-7.7,0-15-1.4-21.8-4.3s-12.8-6.8-17.9-11.7c-5.1-4.9-9.1-10.8-12.1-17.4
                        c-2.9-6.7-4.4-13.8-4.4-21.3c0-7.5,1.5-14.6,4.4-21.3c2.9-6.7,7-12.5,12.1-17.4c5.1-4.9,11.1-8.9,17.9-11.7s14.1-4.3,21.8-4.3
                        c7.8,0,15.2,1.4,22,4.3c6.8,2.9,12.8,6.8,17.9,11.7c5.1,4.9,9.1,10.8,12.1,17.4c2.9,6.7,4.4,13.8,4.4,21.3
                        c0,7.5-1.5,14.6-4.4,21.3c-2.9,6.7-7,12.5-12.1,17.4c-5.1,4.9-11.1,8.9-17.9,11.7C852.4,522.3,845.1,523.7,837.2,523.7z
                         M837.2,432.1c-5.2,0-10.2,1-14.8,2.9c-4.7,1.9-8.7,4.5-12.2,7.9c-3.5,3.4-6.2,7.3-8.2,11.7c-2,4.5-3,9.2-3,14.3s1,9.9,3,14.3
                        c2,4.5,4.8,8.4,8.2,11.7c3.5,3.4,7.6,6,12.2,7.9c4.7,1.9,9.6,2.9,14.8,2.9c5.3,0,10.3-0.9,15-2.9c4.7-1.9,8.7-4.5,12.2-7.9
                        c3.5-3.4,6.2-7.3,8.2-11.7c2-4.5,3-9.2,3-14.3s-1-9.9-3-14.3c-2-4.5-4.8-8.4-8.2-11.7c-3.5-3.4-7.6-6-12.2-7.9
                        C847.6,433,842.6,432.1,837.2,432.1z"}]])
      [:g {}
       [:clipPath {:id (str id "-cp")}
        [:path {:d "M536.9,297.1c3.2,4.7,5.1,10.5,5.1,16.6c0,16.3-13.2,29.5-29.5,29.5c-16.3,0-29.5-13.2-29.5-29.5
                                c0-16.3,13.2-29.5,29.5-29.5c4.7,0,9.2,1.1,13.2,3.1l137.1-157.2c-2.1-3.6-3.4-7.7-3.4-12.2c0-13.2,10.7-36.8,23.8-36.8
                                c4.7,0,10.7,2.6,16.6,6.5l11.3-13c2.7-3.1,7.4-3.4,10.5-0.7c3.1,2.7,3.4,7.4,0.7,10.5l-11.2,12.8c5.2,5.7,8.9,11.9,8.9,17.1
                                c0,13.2-23.6,27.4-36.8,27.4c-3.3,0-6.4-0.7-9.3-1.9L536.9,297.1z M351.3,198.6c0-18.1-14.7-32.7-32.7-32.7s-32.7,14.7-32.7,32.7
                                c0,18.1,14.7,32.7,32.7,32.7S351.3,216.7,351.3,198.6z M364.8,77.7c-16.3,0-29.5,13.2-29.5,29.5c0,16.3,13.2,29.5,29.5,29.5
                                c16.3,0,29.5-13.2,29.5-29.5C394.4,90.9,381.2,77.7,364.8,77.7z M428.3,88c9.4,0,17.1-7.7,17.1-17.1c0-9.4-7.7-17.1-17.1-17.1
                                s-17.1,7.7-17.1,17.1C411.2,80.3,418.9,88,428.3,88z M504.8,82c12.8,0,23.2-10.4,23.2-23.2s-10.4-23.2-23.2-23.2
                                s-23.2,10.4-23.2,23.2S492,82,504.8,82z M618.6,107.2c19.4,0,35.1-15.7,35.1-35.1S638,36.9,618.6,36.9
                                c-19.4,0-35.1,15.7-35.1,35.1S599.2,107.2,618.6,107.2z M704.2,228.8c0,12.1,9.8,21.9,21.9,21.9s21.9-9.8,21.9-21.9
                                c0-12.1-9.8-21.9-21.9-21.9S704.2,216.7,704.2,228.8z M712.1,278.8c-22.4,0-40.6,18.2-40.6,40.6c0,22.4,18.2,40.6,40.6,40.6
                                c22.4,0,40.6-18.2,40.6-40.6C752.7,296.9,734.5,278.8,712.1,278.8z M694,189.8c0-9.5-7.7-17.1-17.1-17.1
                                c-9.5,0-17.1,7.7-17.1,17.1c0,9.5,7.7,17.1,17.1,17.1C686.4,206.9,694,199.2,694,189.8z M629.3,241.3
                                c-13.2,0-23.9,10.7-23.9,23.9c0,13.2,10.7,23.9,23.9,23.9c13.2,0,23.9-10.7,23.9-23.9C653.2,252,642.5,241.3,629.3,241.3z
                                 M476.7,168c17.3,0,31.3-14,31.3-31.3c0-17.3-14-31.3-31.3-31.3c-17.3,0-31.3,14-31.3,31.3C445.4,154,459.4,168,476.7,168z
                                 M434.4,198.6c0-12.8-10.4-23.1-23.1-23.1c-12.8,0-23.1,10.4-23.1,23.1c0,12.8,10.4,23.1,23.1,23.1
                                C424,221.8,434.4,211.4,434.4,198.6z M428.3,268.7c-16.4,0-29.6,13.3-29.6,29.6c0,16.4,13.3,29.6,29.6,29.6s29.6-13.3,29.6-29.6
                                C457.9,282,444.7,268.7,428.3,268.7z M358.3,245.7c-12.7,0-23,10.3-23,23c0,12.7,10.3,23,23,23s23-10.3,23-23
                                C381.3,256,371,245.7,358.3,245.7z M605.4,445.6c-13.2,0-23.9,10.7-23.9,23.9c0,13.2,10.7,23.9,23.9,23.9s23.9-10.7,23.9-23.9
                                C629.3,456.3,618.6,445.6,605.4,445.6z M602.5,313.8c-22.5,0-40.8,18.3-40.8,40.8s18.3,40.8,40.8,40.8
                                c22.5,0,40.8-18.3,40.8-40.8S625.1,313.8,602.5,313.8z M535.1,226.7c3.9-13.8,7.3-27.8,11.1-41.6c4.9-17.9,9.3-35.8,14-53.8
                                c0.3-1.3,0.8-2.5,1.4-3.7c1.3-2.4,3.5-3.4,6.2-2.7c2.9,0.7,4.7,2.8,6.2,5.1c1.8,2.8,3.4,5.7,5,8.6c8.1,14.2,9,29,4,44.4
                                c-0.7,2.1-0.7,4.2,0.1,6.2c0.9,2.1,2.7,2.9,4.8,2.2c1.3-0.4,2.4-1.2,3.2-2.3c3.6-5.2,6.5-10.7,8-16.9c2.2-10.3,1.7-20.3-2.2-30.2
                                c-3.8-9.7-8.8-18.7-13.7-27.8c-4.3-8-8.2-16.2-9.7-25.3c-0.4-2.4-1.2-4.8-2-7.1c-1.3-3.8-6.2-5.2-9.2-2.7
                                c-1.4,1.2-1.8,2.9-2.3,4.6c-4.9,18-9.2,36.2-14.3,54.1c-4.5,16.1-8.7,32.4-13.1,48.6c-1.4,5.2-2.9,10.4-4.4,15.7
                                c-0.4,1.4-1.1,2.8-1.9,4c-2.3,3.6-4.2,4.1-7.8,1.8c-4.2-2.7-8.6-4.8-13.4-6.1c-12-3.1-23.8-1.8-35.1,3.2
                                c-7.1,3.1-12.7,8.3-16.5,15.2c-5.6,10.3-3.8,21.3,5.2,28.8c7.1,5.9,15.5,9.1,24.8,9.6C520.9,263.1,534,230.4,535.1,226.7z"}]]
       [:linearGradient {:id gradient-id
                         :gradientUnits "userSpaceOnUse"
                         :x1 "324.8879"
                         :y1 "21.2758"
                         :x2 "718.0211"
                         :y2 "479.1865"}
        (let [n (count (:gradient theme))
              m (dec n)]
          (for [i (range n)]
            [:stop {:offset (if (= i m)
                              1
                              (str (/ i m))) :stop-color (nth (:gradient theme) i)}]))]
       [:path {:clip-path (str "url(#" id "-cp)")
               :fill (str "url(#" gradient-id ")")
               :d "M771.6,378.9c0,58.5-50,106-111.6,163.2H387.7
                        c-61.6-57.2-111.6-104.6-111.6-163.2V120.2c0-58.5,50-106,111.6-106H660c61.6,0,111.6,47.4,111.6,106V378.9z"}]]]]))
